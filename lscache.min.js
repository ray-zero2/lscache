!function(a,b){"function"==typeof define&&define.amd?define([],b):"undefined"!=typeof module&&module.exports?module.exports=b():a.lscache=b()}(this,function(){function a(){var a="__lscachetest__",c=a;if(void 0!==p)return p;try{if(!localStorage)return!1}catch(a){return!1}try{h(a,c),i(a),p=!0}catch(a){p=!(!b(a)||!localStorage.length)}return p}function b(a){return a&&("QUOTA_EXCEEDED_ERR"===a.name||"NS_ERROR_DOM_QUOTA_REACHED"===a.name||"QuotaExceededError"===a.name)}function c(){return void 0===q&&(q=null!=window.JSON),q}function d(a){return a.replace(/[[\]{}()*+?.\\^$|]/g,"\\$&")}function e(a){return a+s}function f(){return Math.floor((new Date).getTime()/u)}function g(a){return localStorage.getItem(r+w+a)}function h(a,b){localStorage.removeItem(r+w+a),localStorage.setItem(r+w+a,b)}function i(a){localStorage.removeItem(r+w+a)}function j(a){var b,c,f=new RegExp("^"+r+d(w)+"(.*)"),g=[];for(c=0;c<localStorage.length;c++)b=localStorage.key(c),b=b&&b.match(f),b=b&&b[1],b&&b.indexOf(s)<0&&g.push(b);for(c=0;c<g.length;c++)a(g[c],e(g[c]))}function k(a){var b=e(a);i(a),i(b)}function l(a){var b=e(a),c=g(b);if(!c)return!1;var d=parseInt(c,t);return f()>=d}function m(a){var b=e(a);if(l(a))return i(a),i(b),!0}function n(a,b){x&&"console"in window&&"function"==typeof window.console.warn&&(window.console.warn("lscache - "+a),b&&window.console.warn("lscache - The error was: "+b.message))}function o(a){return Math.floor(864e13/a)}var p,q,r="lscache-",s="-cacheexpiration",t=10,u=6e4,v=o(u),w="",x=!1,y={set:function(d,l,m){if(!a())return!1;if(!c())return!1;try{l=JSON.stringify(l)}catch(a){return!1}try{h(d,l)}catch(a){if(!b(a))return n("Could not add item with key '"+d+"'",a),!1;var o,p=[];j(function(a,b){var c=g(b);c=c?parseInt(c,t):v,p.push({key:a,size:(g(a)||"").length,expiration:c})}),p.sort(function(a,b){return b.expiration-a.expiration});for(var q=(l||"").length;p.length&&q>0;)o=p.pop(),n("Cache is full, removing item with key '"+o.key+"'"),k(o.key),q-=o.size;try{h(d,l)}catch(a){return n("Could not add item with key '"+d+"', perhaps it's too big?",a),!1}}return m?h(e(d),(f()+m).toString(t)):i(e(d)),!0},get:function(b){if(!a())return null;if(l(b))return null;var d=g(b);if(!d||!c())return d;try{return JSON.parse(d)}catch(a){return d}},remove:function(b){a()&&k(b)},supported:function(){return a()},flush:function(){a()&&j(function(a){k(a)})},flushExpired:function(){a()&&j(function(a){m(a)})},setBucket:function(a){w=a},resetBucket:function(){w=""},getExpiryMilliseconds:function(){return u},setExpiryMilliseconds:function(a){u=a,v=o(u)},enableWarnings:function(a){x=a}};return y});